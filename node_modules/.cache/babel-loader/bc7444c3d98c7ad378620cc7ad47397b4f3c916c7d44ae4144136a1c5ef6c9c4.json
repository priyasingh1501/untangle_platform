{"ast":null,"code":"import _objectSpread from\"/Users/priyas/Desktop/untangle-platform/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState}from'react';import{useAuth}from'../../contexts/AuthContext';import{buildApiUrl}from'../../config';import{componentStyles}from'../../styles/designTokens';import ConsistentPopup from'../ui/ConsistentPopup.jsx';import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";const CreateTaskPopup=_ref=>{let{isOpen,onClose,onTaskCreated,goalId,goalName}=_ref;const{token}=useAuth();const[loading,setLoading]=useState(false);const[formData,setFormData]=useState({title:'',estimatedDuration:'30'});// Debug logging\nconsole.log('CreateTaskPopup props:',{isOpen,goalId,goalName,token:!!token});console.log('Token value:',token?token.substring(0,20)+'...':'No token');const handleInputChange=(field,value)=>{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[field]:value}));};const handleSubmit=async e=>{e.preventDefault();setLoading(true);const taskData=_objectSpread(_objectSpread({},formData),{},{goalIds:goalId?[goalId]:[],estimatedDuration:parseInt(formData.estimatedDuration)||30,// Auto-complete tasks created in Goal Aligned Day\nstatus:'completed',completedAt:new Date().toISOString(),actualDuration:parseInt(formData.estimatedDuration)||30});console.log('Creating task with data:',taskData);console.log('API URL:',buildApiUrl('/api/tasks'));try{const response=await fetch(buildApiUrl('/api/tasks'),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(token)},body:JSON.stringify(taskData)});console.log('Task creation response status:',response.status);if(response.ok){const data=await response.json();console.log('Task created successfully:',data);onTaskCreated(data.task);onClose();// Reset form\nsetFormData({title:'',estimatedDuration:'30'});}else{const error=await response.json();console.error('Task creation failed:',{status:response.status,statusText:response.statusText,error:error});alert(\"Error creating task: \".concat(error.message||'Unknown error'));}}catch(error){console.error('Error creating task:',error);alert('Error creating task. Please try again.');}finally{setLoading(false);}};if(!isOpen)return null;return/*#__PURE__*/_jsxs(ConsistentPopup,{isOpen:isOpen,onClose:onClose,title:\"ADD TASK\",maxWidth:\"md\",children:[goalName&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-text-secondary mb-4 font-jakarta\",children:[\"for goal: \",goalName]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-text-secondary mb-2 font-jakarta tracking-wider\",children:\"TASK TITLE *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.title,onChange:e=>handleInputChange('title',e.target.value),placeholder:\"Enter task title...\",required:true,className:componentStyles.input.base})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-text-secondary mb-2 font-jakarta tracking-wider\",children:\"DURATION (MINUTES)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"5\",step:\"5\",value:formData.estimatedDuration,onChange:e=>handleInputChange('estimatedDuration',e.target.value),placeholder:\"30\",className:componentStyles.input.base})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3 pt-4\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:onClose,className:componentStyles.button.outline+\" flex-1\",children:\"CANCEL\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading||!formData.title,className:componentStyles.button.primary+\" flex-1\",children:loading?'CREATING...':'ADD & COMPLETE TASK'})]})]})]});};export default CreateTaskPopup;","map":{"version":3,"names":["React","useState","useAuth","buildApiUrl","componentStyles","ConsistentPopup","jsxs","_jsxs","jsx","_jsx","CreateTaskPopup","_ref","isOpen","onClose","onTaskCreated","goalId","goalName","token","loading","setLoading","formData","setFormData","title","estimatedDuration","console","log","substring","handleInputChange","field","value","prev","_objectSpread","handleSubmit","e","preventDefault","taskData","goalIds","parseInt","status","completedAt","Date","toISOString","actualDuration","response","fetch","method","headers","concat","body","JSON","stringify","ok","data","json","task","error","statusText","alert","message","maxWidth","children","className","onSubmit","type","onChange","target","placeholder","required","input","base","min","step","onClick","button","outline","disabled","primary"],"sources":["/Users/priyas/Desktop/untangle-platform/src/components/tasks/CreateTaskPopup.jsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { useAuth } from '../../contexts/AuthContext';\nimport { buildApiUrl } from '../../config';\nimport { componentStyles } from '../../styles/designTokens';\nimport ConsistentPopup from '../ui/ConsistentPopup.jsx';\n\nconst CreateTaskPopup = ({ isOpen, onClose, onTaskCreated, goalId, goalName }) => {\n  const { token } = useAuth();\n  const [loading, setLoading] = useState(false);\n  \n  const [formData, setFormData] = useState({\n    title: '',\n    estimatedDuration: '30'\n  });\n\n  // Debug logging\n  console.log('CreateTaskPopup props:', { isOpen, goalId, goalName, token: !!token });\n  console.log('Token value:', token ? token.substring(0, 20) + '...' : 'No token');\n\n  const handleInputChange = (field, value) => {\n    setFormData(prev => ({\n      ...prev,\n      [field]: value\n    }));\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setLoading(true);\n\n    const taskData = {\n      ...formData,\n      goalIds: goalId ? [goalId] : [],\n      estimatedDuration: parseInt(formData.estimatedDuration) || 30,\n      // Auto-complete tasks created in Goal Aligned Day\n      status: 'completed',\n      completedAt: new Date().toISOString(),\n      actualDuration: parseInt(formData.estimatedDuration) || 30\n    };\n\n    console.log('Creating task with data:', taskData);\n    console.log('API URL:', buildApiUrl('/api/tasks'));\n\n    try {\n      const response = await fetch(buildApiUrl('/api/tasks'), {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        },\n        body: JSON.stringify(taskData)\n      });\n\n      console.log('Task creation response status:', response.status);\n\n      if (response.ok) {\n        const data = await response.json();\n        console.log('Task created successfully:', data);\n        onTaskCreated(data.task);\n        onClose();\n        // Reset form\n        setFormData({\n          title: '',\n          estimatedDuration: '30'\n        });\n      } else {\n        const error = await response.json();\n        console.error('Task creation failed:', {\n          status: response.status,\n          statusText: response.statusText,\n          error: error\n        });\n        alert(`Error creating task: ${error.message || 'Unknown error'}`);\n      }\n    } catch (error) {\n      console.error('Error creating task:', error);\n      alert('Error creating task. Please try again.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <ConsistentPopup\n      isOpen={isOpen}\n      onClose={onClose}\n      title=\"ADD TASK\"\n      maxWidth=\"md\"\n    >\n      {goalName && (\n        <p className=\"text-sm text-text-secondary mb-4 font-jakarta\">for goal: {goalName}</p>\n      )}\n\n      <form onSubmit={handleSubmit} className=\"space-y-4\">\n        {/* Task Title */}\n        <div>\n          <label className=\"block text-sm font-medium text-text-secondary mb-2 font-jakarta tracking-wider\">\n            TASK TITLE *\n          </label>\n          <input\n            type=\"text\"\n            value={formData.title}\n            onChange={(e) => handleInputChange('title', e.target.value)}\n            placeholder=\"Enter task title...\"\n            required\n            className={componentStyles.input.base}\n          />\n        </div>\n\n        {/* Estimated Duration */}\n        <div>\n          <label className=\"block text-sm font-medium text-text-secondary mb-2 font-jakarta tracking-wider\">\n            DURATION (MINUTES)\n          </label>\n          <input\n            type=\"number\"\n            min=\"5\"\n            step=\"5\"\n            value={formData.estimatedDuration}\n            onChange={(e) => handleInputChange('estimatedDuration', e.target.value)}\n            placeholder=\"30\"\n            className={componentStyles.input.base}\n          />\n        </div>\n\n        {/* Action Buttons */}\n        <div className=\"flex space-x-3 pt-4\">\n          <button\n            type=\"button\"\n            onClick={onClose}\n            className={componentStyles.button.outline + \" flex-1\"}\n          >\n            CANCEL\n          </button>\n          <button\n            type=\"submit\"\n            disabled={loading || !formData.title}\n            className={componentStyles.button.primary + \" flex-1\"}\n          >\n            {loading ? 'CREATING...' : 'ADD & COMPLETE TASK'}\n          </button>\n        </div>\n      </form>\n    </ConsistentPopup>\n  );\n};\n\nexport default CreateTaskPopup;\n"],"mappings":"4HAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,KAAQ,OAAO,CACvC,OAASC,OAAO,KAAQ,4BAA4B,CACpD,OAASC,WAAW,KAAQ,cAAc,CAC1C,OAASC,eAAe,KAAQ,2BAA2B,CAC3D,MAAO,CAAAC,eAAe,KAAM,2BAA2B,CAAC,OAAAC,IAAA,IAAAC,KAAA,CAAAC,GAAA,IAAAC,IAAA,yBAExD,KAAM,CAAAC,eAAe,CAAGC,IAAA,EAA0D,IAAzD,CAAEC,MAAM,CAAEC,OAAO,CAAEC,aAAa,CAAEC,MAAM,CAAEC,QAAS,CAAC,CAAAL,IAAA,CAC3E,KAAM,CAAEM,KAAM,CAAC,CAAGf,OAAO,CAAC,CAAC,CAC3B,KAAM,CAACgB,OAAO,CAAEC,UAAU,CAAC,CAAGlB,QAAQ,CAAC,KAAK,CAAC,CAE7C,KAAM,CAACmB,QAAQ,CAAEC,WAAW,CAAC,CAAGpB,QAAQ,CAAC,CACvCqB,KAAK,CAAE,EAAE,CACTC,iBAAiB,CAAE,IACrB,CAAC,CAAC,CAEF;AACAC,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAE,CAAEb,MAAM,CAAEG,MAAM,CAAEC,QAAQ,CAAEC,KAAK,CAAE,CAAC,CAACA,KAAM,CAAC,CAAC,CACnFO,OAAO,CAACC,GAAG,CAAC,cAAc,CAAER,KAAK,CAAGA,KAAK,CAACS,SAAS,CAAC,CAAC,CAAE,EAAE,CAAC,CAAG,KAAK,CAAG,UAAU,CAAC,CAEhF,KAAM,CAAAC,iBAAiB,CAAGA,CAACC,KAAK,CAAEC,KAAK,GAAK,CAC1CR,WAAW,CAACS,IAAI,EAAAC,aAAA,CAAAA,aAAA,IACXD,IAAI,MACP,CAACF,KAAK,EAAGC,KAAK,EACd,CAAC,CACL,CAAC,CAED,KAAM,CAAAG,YAAY,CAAG,KAAO,CAAAC,CAAC,EAAK,CAChCA,CAAC,CAACC,cAAc,CAAC,CAAC,CAClBf,UAAU,CAAC,IAAI,CAAC,CAEhB,KAAM,CAAAgB,QAAQ,CAAAJ,aAAA,CAAAA,aAAA,IACTX,QAAQ,MACXgB,OAAO,CAAErB,MAAM,CAAG,CAACA,MAAM,CAAC,CAAG,EAAE,CAC/BQ,iBAAiB,CAAEc,QAAQ,CAACjB,QAAQ,CAACG,iBAAiB,CAAC,EAAI,EAAE,CAC7D;AACAe,MAAM,CAAE,WAAW,CACnBC,WAAW,CAAE,GAAI,CAAAC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CACrCC,cAAc,CAAEL,QAAQ,CAACjB,QAAQ,CAACG,iBAAiB,CAAC,EAAI,EAAE,EAC3D,CAEDC,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAEU,QAAQ,CAAC,CACjDX,OAAO,CAACC,GAAG,CAAC,UAAU,CAAEtB,WAAW,CAAC,YAAY,CAAC,CAAC,CAElD,GAAI,CACF,KAAM,CAAAwC,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAACzC,WAAW,CAAC,YAAY,CAAC,CAAE,CACtD0C,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACP,cAAc,CAAE,kBAAkB,CAClC,eAAe,WAAAC,MAAA,CAAY9B,KAAK,CAClC,CAAC,CACD+B,IAAI,CAAEC,IAAI,CAACC,SAAS,CAACf,QAAQ,CAC/B,CAAC,CAAC,CAEFX,OAAO,CAACC,GAAG,CAAC,gCAAgC,CAAEkB,QAAQ,CAACL,MAAM,CAAC,CAE9D,GAAIK,QAAQ,CAACQ,EAAE,CAAE,CACf,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAT,QAAQ,CAACU,IAAI,CAAC,CAAC,CAClC7B,OAAO,CAACC,GAAG,CAAC,4BAA4B,CAAE2B,IAAI,CAAC,CAC/CtC,aAAa,CAACsC,IAAI,CAACE,IAAI,CAAC,CACxBzC,OAAO,CAAC,CAAC,CACT;AACAQ,WAAW,CAAC,CACVC,KAAK,CAAE,EAAE,CACTC,iBAAiB,CAAE,IACrB,CAAC,CAAC,CACJ,CAAC,IAAM,CACL,KAAM,CAAAgC,KAAK,CAAG,KAAM,CAAAZ,QAAQ,CAACU,IAAI,CAAC,CAAC,CACnC7B,OAAO,CAAC+B,KAAK,CAAC,uBAAuB,CAAE,CACrCjB,MAAM,CAAEK,QAAQ,CAACL,MAAM,CACvBkB,UAAU,CAAEb,QAAQ,CAACa,UAAU,CAC/BD,KAAK,CAAEA,KACT,CAAC,CAAC,CACFE,KAAK,yBAAAV,MAAA,CAAyBQ,KAAK,CAACG,OAAO,EAAI,eAAe,CAAE,CAAC,CACnE,CACF,CAAE,MAAOH,KAAK,CAAE,CACd/B,OAAO,CAAC+B,KAAK,CAAC,sBAAsB,CAAEA,KAAK,CAAC,CAC5CE,KAAK,CAAC,wCAAwC,CAAC,CACjD,CAAC,OAAS,CACRtC,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAED,GAAI,CAACP,MAAM,CAAE,MAAO,KAAI,CAExB,mBACEL,KAAA,CAACF,eAAe,EACdO,MAAM,CAAEA,MAAO,CACfC,OAAO,CAAEA,OAAQ,CACjBS,KAAK,CAAC,UAAU,CAChBqC,QAAQ,CAAC,IAAI,CAAAC,QAAA,EAEZ5C,QAAQ,eACPT,KAAA,MAAGsD,SAAS,CAAC,+CAA+C,CAAAD,QAAA,EAAC,YAAU,CAAC5C,QAAQ,EAAI,CACrF,cAEDT,KAAA,SAAMuD,QAAQ,CAAE9B,YAAa,CAAC6B,SAAS,CAAC,WAAW,CAAAD,QAAA,eAEjDrD,KAAA,QAAAqD,QAAA,eACEnD,IAAA,UAAOoD,SAAS,CAAC,gFAAgF,CAAAD,QAAA,CAAC,cAElG,CAAO,CAAC,cACRnD,IAAA,UACEsD,IAAI,CAAC,MAAM,CACXlC,KAAK,CAAET,QAAQ,CAACE,KAAM,CACtB0C,QAAQ,CAAG/B,CAAC,EAAKN,iBAAiB,CAAC,OAAO,CAAEM,CAAC,CAACgC,MAAM,CAACpC,KAAK,CAAE,CAC5DqC,WAAW,CAAC,qBAAqB,CACjCC,QAAQ,MACRN,SAAS,CAAEzD,eAAe,CAACgE,KAAK,CAACC,IAAK,CACvC,CAAC,EACC,CAAC,cAGN9D,KAAA,QAAAqD,QAAA,eACEnD,IAAA,UAAOoD,SAAS,CAAC,gFAAgF,CAAAD,QAAA,CAAC,oBAElG,CAAO,CAAC,cACRnD,IAAA,UACEsD,IAAI,CAAC,QAAQ,CACbO,GAAG,CAAC,GAAG,CACPC,IAAI,CAAC,GAAG,CACR1C,KAAK,CAAET,QAAQ,CAACG,iBAAkB,CAClCyC,QAAQ,CAAG/B,CAAC,EAAKN,iBAAiB,CAAC,mBAAmB,CAAEM,CAAC,CAACgC,MAAM,CAACpC,KAAK,CAAE,CACxEqC,WAAW,CAAC,IAAI,CAChBL,SAAS,CAAEzD,eAAe,CAACgE,KAAK,CAACC,IAAK,CACvC,CAAC,EACC,CAAC,cAGN9D,KAAA,QAAKsD,SAAS,CAAC,qBAAqB,CAAAD,QAAA,eAClCnD,IAAA,WACEsD,IAAI,CAAC,QAAQ,CACbS,OAAO,CAAE3D,OAAQ,CACjBgD,SAAS,CAAEzD,eAAe,CAACqE,MAAM,CAACC,OAAO,CAAG,SAAU,CAAAd,QAAA,CACvD,QAED,CAAQ,CAAC,cACTnD,IAAA,WACEsD,IAAI,CAAC,QAAQ,CACbY,QAAQ,CAAEzD,OAAO,EAAI,CAACE,QAAQ,CAACE,KAAM,CACrCuC,SAAS,CAAEzD,eAAe,CAACqE,MAAM,CAACG,OAAO,CAAG,SAAU,CAAAhB,QAAA,CAErD1C,OAAO,CAAG,aAAa,CAAG,qBAAqB,CAC1C,CAAC,EACN,CAAC,EACF,CAAC,EACQ,CAAC,CAEtB,CAAC,CAED,cAAe,CAAAR,eAAe","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}