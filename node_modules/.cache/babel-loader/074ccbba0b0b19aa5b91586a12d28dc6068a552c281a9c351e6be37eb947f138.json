{"ast":null,"code":"import React,{useState,useEffect,useCallback}from'react';import{useAuth}from'../../contexts/AuthContext';import{buildApiUrl}from'../../config';import{RefreshCw,Utensils,Calendar,BarChart3}from'lucide-react';import Card from'../ui/Card';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const DailyMealKPIs=_ref=>{let{refreshTrigger}=_ref;const{token}=useAuth();const[dailyMeals,setDailyMeals]=useState([]);const[weeklyMeals,setWeeklyMeals]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[selectedEffect,setSelectedEffect]=useState(null);const[selectedMeal,setSelectedMeal]=useState(null);const[refreshing,setRefreshing]=useState(false);const[activeTab,setActiveTab]=useState('daily');// Get today's local date in YYYY-MM-DD format (avoid UTC shift)\nconst getTodayDate=()=>{const today=new Date();const year=today.getFullYear();const month=String(today.getMonth()+1).padStart(2,'0');const day=String(today.getDate()).padStart(2,'0');return\"\".concat(year,\"-\").concat(month,\"-\").concat(day);};// Get date range for past 7 days\nconst getWeeklyDateRange=()=>{const today=new Date();const weekAgo=new Date(today);weekAgo.setDate(today.getDate()-6);// 7 days including today\nconst formatDate=date=>{const year=date.getFullYear();const month=String(date.getMonth()+1).padStart(2,'0');const day=String(date.getDate()).padStart(2,'0');return\"\".concat(year,\"-\").concat(month,\"-\").concat(day);};return{startDate:formatDate(weekAgo),endDate:formatDate(today)};};// Fetch meals for today\nconst fetchTodayMeals=useCallback(async function(){let isRefresh=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(!token){return;}if(isRefresh){setRefreshing(true);}else{setLoading(true);}try{const today=getTodayDate();const response=await fetch(\"\".concat(buildApiUrl('/api/meals'),\"?startDate=\").concat(today,\"&endDate=\").concat(today),{headers:{'Authorization':\"Bearer \".concat(token)}});if(!response.ok){const errorData=await response.json().catch(()=>({}));console.error('DailyMealKPIs: Failed to fetch meals:',response.status,errorData);throw new Error(\"Failed to fetch meals: \".concat(errorData.message||'Unknown error'));}const data=await response.json();setDailyMeals(data.meals||[]);setError(null);}catch(err){console.error('Error fetching today\\'s meals:',err);setError(err.message);}finally{setLoading(false);setRefreshing(false);}},[token]);// Fetch meals for past 7 days\nconst fetchWeeklyMeals=useCallback(async function(){let isRefresh=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(!token){return;}if(isRefresh){setRefreshing(true);}else{setLoading(true);}try{const{startDate,endDate}=getWeeklyDateRange();const response=await fetch(\"\".concat(buildApiUrl('/api/meals'),\"?startDate=\").concat(startDate,\"&endDate=\").concat(endDate),{headers:{'Authorization':\"Bearer \".concat(token)}});if(!response.ok){const errorData=await response.json().catch(()=>({}));console.error('DailyMealKPIs: Failed to fetch weekly meals:',response.status,errorData);throw new Error(\"Failed to fetch weekly meals: \".concat(errorData.message||'Unknown error'));}const data=await response.json();setWeeklyMeals(data.meals||[]);setError(null);}catch(err){console.error('Error fetching weekly meals:',err);setError(err.message);}finally{setLoading(false);setRefreshing(false);}},[token]);useEffect(()=>{fetchTodayMeals();fetchWeeklyMeals();},[fetchTodayMeals,fetchWeeklyMeals]);// Respond to refresh trigger from parent component\nuseEffect(()=>{if(refreshTrigger>0){fetchTodayMeals(true);fetchWeeklyMeals(true);}},[refreshTrigger,fetchTodayMeals,fetchWeeklyMeals]);// Handle manual refresh\nconst handleRefresh=()=>{if(activeTab==='daily'){fetchTodayMeals(true);}else{fetchWeeklyMeals(true);}};// Helper function to format meal time\nconst formatMealTime=timestamp=>{if(!timestamp)return'Unknown time';const date=new Date(timestamp);return date.toLocaleTimeString('en-US',{hour:'2-digit',minute:'2-digit',hour12:true});};// Helper function to get meal effect level\nconst getMealEffectLevel=score=>{if(score>=8)return{level:'Excellent',color:'text-[#1E49C9]'};if(score>=6)return{level:'Good',color:'text-blue-600'};if(score>=4)return{level:'Medium',color:'text-yellow-600'};return{level:'Needs Attention',color:'text-red-600'};};const handleEffectClick=(effectKey,effectData,meal)=>{console.log('🔍 Effect clicked:',effectKey,effectData);setSelectedEffect({key:effectKey,data:effectData});setSelectedMeal(meal);};const closeEffectDetails=()=>{setSelectedEffect(null);setSelectedMeal(null);};// Icons and labels for effects\nconst icons={strength:'Strength',immunity:'Immunity',inflammation:'Inflammation',antiInflammatory:'Anti-Inflammatory',energizing:'Energizing',gutFriendly:'Gut Friendly',moodLifting:'Mood',fatForming:'Fat Forming'};const labels={strength:'Strength',immunity:'Immunity',inflammation:'Inflammatory',antiInflammatory:'Anti-Inflammatory',energizing:'Energy',gutFriendly:'Gut Health',moodLifting:'Mood',fatForming:'Fat Formation'};// Get current data based on active tab\nconst getCurrentMeals=()=>{return activeTab==='daily'?dailyMeals:weeklyMeals;};// Calculate nutrition totals for current period\nconst calculateNutrition=meals=>{return meals.reduce((acc,meal)=>{var _meal$computed;if((_meal$computed=meal.computed)!==null&&_meal$computed!==void 0&&_meal$computed.totals){Object.keys(meal.computed.totals).forEach(nutrient=>{acc[nutrient]=(acc[nutrient]||0)+(meal.computed.totals[nutrient]||0);});}return acc;},{});};// Calculate aggregated effects for current period\nconst calculateEffects=meals=>{return meals.reduce((acc,meal)=>{var _meal$computed2;if((_meal$computed2=meal.computed)!==null&&_meal$computed2!==void 0&&_meal$computed2.effects){Object.entries(meal.computed.effects).forEach(_ref2=>{let[effectKey,effectData]=_ref2;if(!acc[effectKey]){acc[effectKey]={score:0,level:'Very Low',why:[]};}// Sum up scores\nacc[effectKey].score+=effectData.score||0;// Combine reasons (avoid duplicates)\nif(effectData.why&&Array.isArray(effectData.why)){effectData.why.forEach(reason=>{if(!acc[effectKey].why.includes(reason)){acc[effectKey].why.push(reason);}});}});}return acc;},{});};// Get current data based on active tab\nconst currentMeals=getCurrentMeals();const currentNutrition=calculateNutrition(currentMeals);const currentEffects=calculateEffects(currentMeals);if(loading){return/*#__PURE__*/_jsx(Card,{variant:\"elevated\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"animate-pulse\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-4 bg-background-tertiary rounded w-1/4 mb-4\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 md:grid-cols-4 gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-16 bg-background-tertiary rounded\"}),/*#__PURE__*/_jsx(\"div\",{className:\"h-16 bg-background-tertiary rounded\"}),/*#__PURE__*/_jsx(\"div\",{className:\"h-16 bg-background-tertiary rounded\"}),/*#__PURE__*/_jsx(\"div\",{className:\"h-16 bg-background-tertiary rounded\"})]})]})});}if(error){return/*#__PURE__*/_jsx(Card,{variant:\"elevated\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-jakarta text-sm text-accent mb-4\",children:[\"Error loading meals: \",error]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleRefresh,className:\"px-4 py-2 bg-accent text-white rounded hover:bg-accent/90 transition-colors\",children:\"Try Again\"})]})});}if(!currentMeals.length){return/*#__PURE__*/_jsx(Card,{variant:\"elevated\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 bg-[#2A313A] rounded-full mx-auto mb-4 flex items-center justify-center\",children:/*#__PURE__*/_jsx(Utensils,{className:\"text-[#C9D1D9]\",size:24})}),/*#__PURE__*/_jsxs(\"h3\",{className:\"font-jakarta text-lg font-semibold text-text-primary mb-2\",children:[\"No Meals \",activeTab==='daily'?'Today':'This Week']}),/*#__PURE__*/_jsxs(\"p\",{className:\"font-jakarta text-text-secondary mb-4\",children:[\"Log your meals to see \",activeTab==='daily'?'daily':'weekly',\" nutrition insights\"]}),/*#__PURE__*/_jsx(\"a\",{href:\"/food\",className:\"inline-flex items-center px-4 py-2 bg-[#1E49C9] text-white text-sm rounded-lg hover:bg-[#1E49C9]/80 transition-colors\",children:\"LOG MEAL\"})]})});}return/*#__PURE__*/_jsxs(Card,{variant:\"elevated\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"font-jakarta text-3xl font-bold text-text-primary\",children:\"Nutrition Insights\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:handleRefresh,disabled:refreshing,className:\"flex items-center gap-2 px-3 py-2 font-jakarta text-sm font-medium text-text-secondary hover:text-text-primary disabled:opacity-50 transition-colors bg-background-tertiary rounded-lg border border-border-primary hover:bg-background-secondary\",children:[/*#__PURE__*/_jsx(RefreshCw,{className:\"h-4 w-4 \".concat(refreshing?'animate-spin':'')}),\"Refresh\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2 mb-8 bg-background-tertiary p-2 rounded-xl border border-border-primary\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab('daily'),className:\"flex items-center gap-2 px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 \".concat(activeTab==='daily'?'bg-background-primary text-text-primary shadow-sm border border-border-primary':'text-text-secondary hover:text-text-primary hover:bg-background-secondary'),children:[/*#__PURE__*/_jsx(Calendar,{className:\"h-4 w-4\"}),\"Daily\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab('weekly'),className:\"flex items-center gap-2 px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 \".concat(activeTab==='weekly'?'bg-background-primary text-text-primary shadow-sm border border-border-primary':'text-text-secondary hover:text-text-primary hover:bg-background-secondary'),children:[/*#__PURE__*/_jsx(BarChart3,{className:\"h-4 w-4\"}),\"Weekly\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6 p-6 bg-background-tertiary rounded-xl border border-border-primary\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-4 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-text-primary mb-1\",children:Math.round(currentNutrition.kcal||0)}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-text-secondary font-medium\",children:\"kcal\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-2xl font-bold text-text-primary mb-1\",children:[Math.round(currentNutrition.protein||0),\"g\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-text-secondary font-medium\",children:\"protein\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-2xl font-bold text-text-primary mb-1\",children:[Math.round(currentNutrition.carbs||0),\"g\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-text-secondary font-medium\",children:\"carbs\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-2xl font-bold text-text-primary mb-1\",children:[Math.round(currentNutrition.fat||0),\"g\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-text-secondary font-medium\",children:\"fat\"})]})]}),Object.entries(currentEffects).some(_ref3=>{let[effectKey,effectData]=_ref3;return(effectData.score||0)>0;})&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-6 pt-6 border-t border-border-primary\",children:/*#__PURE__*/_jsxs(\"details\",{className:\"group\",children:[/*#__PURE__*/_jsxs(\"summary\",{className:\"cursor-pointer text-sm font-medium text-text-secondary hover:text-text-primary transition-colors flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Effects\"}),/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 bg-background-primary rounded-full text-xs font-semibold\",children:Object.entries(currentEffects).filter(_ref4=>{let[effectKey,effectData]=_ref4;return(effectData.score||0)>0;}).length})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-3 mt-4\",children:Object.entries(currentEffects).filter(_ref5=>{let[effectKey,effectData]=_ref5;return(effectData.score||0)>0;}).map(_ref6=>{let[effectKey,effectData]=_ref6;const score=effectData.score||0;const bgColor=score>=6?'bg-[#1E49C9]/20 border-[#1E49C9]/30 text-[#1E49C9]':score>=4?'bg-yellow-900/20 border-yellow-500/30 text-yellow-300':'bg-red-900/20 border-red-500/30 text-red-300';return/*#__PURE__*/_jsxs(\"div\",{className:\"px-4 py-2 rounded-lg border text-sm cursor-pointer hover:opacity-80 transition-opacity font-medium \".concat(bgColor),onClick:()=>handleEffectClick(effectKey,effectData,null),children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:labels[effectKey]||effectKey}),/*#__PURE__*/_jsxs(\"span\",{className:\"ml-2 text-xs opacity-75\",children:[\"(\",score,\")\"]})]},effectKey);})})]})})]}),currentMeals.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 bg-background-tertiary rounded-xl border border-border-primary\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-center mb-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm font-medium text-text-secondary\",children:[currentMeals.length,\" meal\",currentMeals.length!==1?'s':'',\" logged \",activeTab==='daily'?'today':'this week']})}),Object.entries(currentEffects).some(_ref7=>{let[effectKey,effectData]=_ref7;return(effectData.score||0)>0;})&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-lg font-semibold text-text-primary mb-4 text-center\",children:[activeTab==='daily'?'Daily':'Weekly',\" Health Impact\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-3 justify-center\",children:Object.entries(currentEffects).filter(_ref8=>{let[effectKey,effectData]=_ref8;return(effectData.score||0)>0;}).sort((a,b)=>(b[1].score||0)-(a[1].score||0)).map(_ref9=>{let[effectKey,effectData]=_ref9;const score=effectData.score||0;const bgColor=score>=6?'bg-[#1E49C9]/20 border-[#1E49C9]/30 text-[#1E49C9]':score>=4?'bg-yellow-900/20 border-yellow-500/30 text-yellow-300':'bg-red-900/20 border-red-500/30 text-red-300';return/*#__PURE__*/_jsxs(\"div\",{className:\"px-4 py-2 rounded-lg border text-sm cursor-pointer hover:opacity-80 transition-opacity font-medium \".concat(bgColor),onClick:()=>handleEffectClick(effectKey,effectData,null),children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:labels[effectKey]||effectKey}),/*#__PURE__*/_jsxs(\"span\",{className:\"ml-2 text-xs opacity-75\",children:[\"(\",score,\")\"]})]},effectKey);})})]})]}),selectedEffect&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-background-secondary border border-border-primary rounded-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold text-text-primary\",children:[icons[selectedEffect.key],\" \",labels[selectedEffect.key],\" Details\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:closeEffectDetails,className:\"text-text-muted hover:text-text-primary transition-colors\",children:\"\\u2715\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium text-text-primary\",children:\"Score\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-lg font-bold \".concat(getMealEffectLevel(selectedEffect.data.score||0).color),children:[selectedEffect.data.score||0,\"/10\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium text-text-primary\",children:\"Level\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-text-secondary\",children:selectedEffect.data.label||selectedEffect.data.level||'N/A'})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-medium text-text-primary mb-2\",children:\"Contributing Factors\"}),selectedEffect.data.why&&selectedEffect.data.why.length>0?/*#__PURE__*/_jsx(\"ul\",{className:\"space-y-1\",children:selectedEffect.data.why.map((reason,index)=>/*#__PURE__*/_jsxs(\"li\",{className:\"text-sm text-text-secondary flex items-start\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"mr-2\",children:\"\\u2022\"}),/*#__PURE__*/_jsx(\"span\",{children:reason})]},index))}):/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-text-muted\",children:\"No specific factors identified\"})]}),selectedEffect.data.aiInsights&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 p-3 bg-blue-900/20 border border-blue-500/30 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:\"AI\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-medium text-blue-300\",children:\"AI Insights\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-blue-200 leading-relaxed\",children:selectedEffect.data.aiInsights})]}),selectedEffect.data.aiEnhanced&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 flex items-center gap-2 text-xs text-[#1E49C9]\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u2728\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Enhanced with AI analysis\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-medium text-text-primary mb-2\",children:selectedMeal?'Meal Items':'All Meals Today'}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:selectedMeal?selectedMeal.items.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-2 bg-background-tertiary rounded\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-text-primary\",children:item.customName}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-text-secondary\",children:[item.grams,\"g\"]})]},index)):currentMeals.filter(meal=>{var _meal$computed3,_meal$computed3$effec,_meal$computed3$effec2;return(((_meal$computed3=meal.computed)===null||_meal$computed3===void 0?void 0:(_meal$computed3$effec=_meal$computed3.effects)===null||_meal$computed3$effec===void 0?void 0:(_meal$computed3$effec2=_meal$computed3$effec[selectedEffect.key])===null||_meal$computed3$effec2===void 0?void 0:_meal$computed3$effec2.score)||0)>0;}).map((meal,mealIndex)=>/*#__PURE__*/_jsxs(\"div\",{className:\"p-2 bg-background-tertiary rounded\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm font-medium text-text-primary mb-1\",children:[\"Meal \",mealIndex+1,\" - \",formatMealTime(meal.ts)]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-1\",children:meal.items.map((item,itemIndex)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between text-xs\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-text-secondary\",children:item.customName}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-text-muted\",children:[item.grams,\"g\"]})]},itemIndex))})]},mealIndex))})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-end\",children:/*#__PURE__*/_jsx(\"button\",{onClick:closeEffectDetails,className:\"px-4 py-2 bg-primary text-white rounded hover:bg-primary/90 transition-colors\",children:\"Close\"})})]})})})]});};export default DailyMealKPIs;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useAuth","buildApiUrl","RefreshCw","Utensils","Calendar","BarChart3","Card","jsx","_jsx","jsxs","_jsxs","DailyMealKPIs","_ref","refreshTrigger","token","dailyMeals","setDailyMeals","weeklyMeals","setWeeklyMeals","loading","setLoading","error","setError","selectedEffect","setSelectedEffect","selectedMeal","setSelectedMeal","refreshing","setRefreshing","activeTab","setActiveTab","getTodayDate","today","Date","year","getFullYear","month","String","getMonth","padStart","day","getDate","concat","getWeeklyDateRange","weekAgo","setDate","formatDate","date","startDate","endDate","fetchTodayMeals","isRefresh","arguments","length","undefined","response","fetch","headers","ok","errorData","json","catch","console","status","Error","message","data","meals","err","fetchWeeklyMeals","handleRefresh","formatMealTime","timestamp","toLocaleTimeString","hour","minute","hour12","getMealEffectLevel","score","level","color","handleEffectClick","effectKey","effectData","meal","log","key","closeEffectDetails","icons","strength","immunity","inflammation","antiInflammatory","energizing","gutFriendly","moodLifting","fatForming","labels","getCurrentMeals","calculateNutrition","reduce","acc","_meal$computed","computed","totals","Object","keys","forEach","nutrient","calculateEffects","_meal$computed2","effects","entries","_ref2","why","Array","isArray","reason","includes","push","currentMeals","currentNutrition","currentEffects","variant","children","className","onClick","size","href","disabled","Math","round","kcal","protein","carbs","fat","some","_ref3","filter","_ref4","_ref5","map","_ref6","bgColor","_ref7","_ref8","sort","a","b","_ref9","label","index","aiInsights","aiEnhanced","items","item","customName","grams","_meal$computed3","_meal$computed3$effec","_meal$computed3$effec2","mealIndex","ts","itemIndex"],"sources":["/Users/priyas/Desktop/untangle-platform/src/components/meal/DailyMealKPIs.jsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { useAuth } from '../../contexts/AuthContext';\nimport { buildApiUrl } from '../../config';\nimport { RefreshCw, Utensils, Calendar, BarChart3 } from 'lucide-react';\nimport Card from '../ui/Card';\n\nconst DailyMealKPIs = ({ refreshTrigger }) => {\n  const { token } = useAuth();\n  const [dailyMeals, setDailyMeals] = useState([]);\n  const [weeklyMeals, setWeeklyMeals] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [selectedEffect, setSelectedEffect] = useState(null);\n  const [selectedMeal, setSelectedMeal] = useState(null);\n  const [refreshing, setRefreshing] = useState(false);\n  const [activeTab, setActiveTab] = useState('daily');\n\n  // Get today's local date in YYYY-MM-DD format (avoid UTC shift)\n  const getTodayDate = () => {\n    const today = new Date();\n    const year = today.getFullYear();\n    const month = String(today.getMonth() + 1).padStart(2, '0');\n    const day = String(today.getDate()).padStart(2, '0');\n    return `${year}-${month}-${day}`;\n  };\n\n  // Get date range for past 7 days\n  const getWeeklyDateRange = () => {\n    const today = new Date();\n    const weekAgo = new Date(today);\n    weekAgo.setDate(today.getDate() - 6); // 7 days including today\n    \n    const formatDate = (date) => {\n      const year = date.getFullYear();\n      const month = String(date.getMonth() + 1).padStart(2, '0');\n      const day = String(date.getDate()).padStart(2, '0');\n      return `${year}-${month}-${day}`;\n    };\n    \n    return {\n      startDate: formatDate(weekAgo),\n      endDate: formatDate(today)\n    };\n  };\n\n\n  // Fetch meals for today\n  const fetchTodayMeals = useCallback(async (isRefresh = false) => {\n    if (!token) {\n      return;\n    }\n\n    if (isRefresh) {\n      setRefreshing(true);\n    } else {\n      setLoading(true);\n    }\n    \n    try {\n      const today = getTodayDate();\n      \n      const response = await fetch(\n        `${buildApiUrl('/api/meals')}?startDate=${today}&endDate=${today}`,\n        {\n          headers: {\n            'Authorization': `Bearer ${token}`,\n          },\n        }\n      );\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        console.error('DailyMealKPIs: Failed to fetch meals:', response.status, errorData);\n        throw new Error(`Failed to fetch meals: ${errorData.message || 'Unknown error'}`);\n      }\n\n      const data = await response.json();\n      setDailyMeals(data.meals || []);\n      setError(null);\n    } catch (err) {\n      console.error('Error fetching today\\'s meals:', err);\n      setError(err.message);\n    } finally {\n      setLoading(false);\n      setRefreshing(false);\n    }\n  }, [token]);\n\n  // Fetch meals for past 7 days\n  const fetchWeeklyMeals = useCallback(async (isRefresh = false) => {\n    if (!token) {\n      return;\n    }\n\n    if (isRefresh) {\n      setRefreshing(true);\n    } else {\n      setLoading(true);\n    }\n    \n    try {\n      const { startDate, endDate } = getWeeklyDateRange();\n      \n      const response = await fetch(\n        `${buildApiUrl('/api/meals')}?startDate=${startDate}&endDate=${endDate}`,\n        {\n          headers: {\n            'Authorization': `Bearer ${token}`,\n          },\n        }\n      );\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        console.error('DailyMealKPIs: Failed to fetch weekly meals:', response.status, errorData);\n        throw new Error(`Failed to fetch weekly meals: ${errorData.message || 'Unknown error'}`);\n      }\n\n      const data = await response.json();\n      setWeeklyMeals(data.meals || []);\n      setError(null);\n    } catch (err) {\n      console.error('Error fetching weekly meals:', err);\n      setError(err.message);\n    } finally {\n      setLoading(false);\n      setRefreshing(false);\n    }\n  }, [token]);\n\n\n  useEffect(() => {\n    fetchTodayMeals();\n    fetchWeeklyMeals();\n  }, [fetchTodayMeals, fetchWeeklyMeals]);\n\n  // Respond to refresh trigger from parent component\n  useEffect(() => {\n    if (refreshTrigger > 0) {\n      fetchTodayMeals(true);\n      fetchWeeklyMeals(true);\n    }\n  }, [refreshTrigger, fetchTodayMeals, fetchWeeklyMeals]);\n\n  // Handle manual refresh\n  const handleRefresh = () => {\n    if (activeTab === 'daily') {\n      fetchTodayMeals(true);\n    } else {\n      fetchWeeklyMeals(true);\n    }\n  };\n\n  // Helper function to format meal time\n  const formatMealTime = (timestamp) => {\n    if (!timestamp) return 'Unknown time';\n    const date = new Date(timestamp);\n    return date.toLocaleTimeString('en-US', { \n      hour: '2-digit', \n      minute: '2-digit',\n      hour12: true \n    });\n  };\n\n  // Helper function to get meal effect level\n  const getMealEffectLevel = (score) => {\n    if (score >= 8) return { level: 'Excellent', color: 'text-[#1E49C9]' };\n    if (score >= 6) return { level: 'Good', color: 'text-blue-600' };\n    if (score >= 4) return { level: 'Medium', color: 'text-yellow-600' };\n    return { level: 'Needs Attention', color: 'text-red-600' };\n  };\n\n  const handleEffectClick = (effectKey, effectData, meal) => {\n    console.log('🔍 Effect clicked:', effectKey, effectData);\n    setSelectedEffect({ key: effectKey, data: effectData });\n    setSelectedMeal(meal);\n  };\n\n  const closeEffectDetails = () => {\n    setSelectedEffect(null);\n    setSelectedMeal(null);\n  };\n\n  // Icons and labels for effects\n  const icons = {\n    strength: 'Strength',\n    immunity: 'Immunity',\n    inflammation: 'Inflammation',\n    antiInflammatory: 'Anti-Inflammatory',\n    energizing: 'Energizing',\n    gutFriendly: 'Gut Friendly',\n    moodLifting: 'Mood',\n    fatForming: 'Fat Forming'\n  };\n\n  const labels = {\n    strength: 'Strength',\n    immunity: 'Immunity',\n    inflammation: 'Inflammatory',\n    antiInflammatory: 'Anti-Inflammatory',\n    energizing: 'Energy',\n    gutFriendly: 'Gut Health',\n    moodLifting: 'Mood',\n    fatForming: 'Fat Formation'\n  };\n\n\n  // Get current data based on active tab\n  const getCurrentMeals = () => {\n    return activeTab === 'daily' ? dailyMeals : weeklyMeals;\n  };\n\n  // Calculate nutrition totals for current period\n  const calculateNutrition = (meals) => {\n    return meals.reduce((acc, meal) => {\n      if (meal.computed?.totals) {\n        Object.keys(meal.computed.totals).forEach(nutrient => {\n          acc[nutrient] = (acc[nutrient] || 0) + (meal.computed.totals[nutrient] || 0);\n        });\n      }\n      return acc;\n    }, {});\n  };\n\n  // Calculate aggregated effects for current period\n  const calculateEffects = (meals) => {\n    return meals.reduce((acc, meal) => {\n      if (meal.computed?.effects) {\n        Object.entries(meal.computed.effects).forEach(([effectKey, effectData]) => {\n          if (!acc[effectKey]) {\n            acc[effectKey] = {\n              score: 0,\n              level: 'Very Low',\n              why: []\n            };\n          }\n          \n          // Sum up scores\n          acc[effectKey].score += effectData.score || 0;\n          \n          // Combine reasons (avoid duplicates)\n          if (effectData.why && Array.isArray(effectData.why)) {\n            effectData.why.forEach(reason => {\n              if (!acc[effectKey].why.includes(reason)) {\n                acc[effectKey].why.push(reason);\n              }\n            });\n          }\n        });\n      }\n      return acc;\n    }, {});\n  };\n\n\n  // Get current data based on active tab\n  const currentMeals = getCurrentMeals();\n  const currentNutrition = calculateNutrition(currentMeals);\n  const currentEffects = calculateEffects(currentMeals);\n  \n  if (loading) {\n    return (\n      <Card variant=\"elevated\">\n        <div className=\"animate-pulse\">\n          <div className=\"h-4 bg-background-tertiary rounded w-1/4 mb-4\"></div>\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n            <div className=\"h-16 bg-background-tertiary rounded\"></div>\n            <div className=\"h-16 bg-background-tertiary rounded\"></div>\n            <div className=\"h-16 bg-background-tertiary rounded\"></div>\n            <div className=\"h-16 bg-background-tertiary rounded\"></div>\n          </div>\n        </div>\n      </Card>\n    );\n  }\n\n  if (error) {\n    return (\n      <Card variant=\"elevated\">\n        <div className=\"text-center\">\n          <p className=\"font-jakarta text-sm text-accent mb-4\">Error loading meals: {error}</p>\n          <button\n            onClick={handleRefresh}\n            className=\"px-4 py-2 bg-accent text-white rounded hover:bg-accent/90 transition-colors\"\n          >\n            Try Again\n          </button>\n        </div>\n      </Card>\n    );\n  }\n\n  if (!currentMeals.length) {\n    return (\n      <Card variant=\"elevated\">\n        <div className=\"text-center py-8\">\n          <div className=\"w-16 h-16 bg-[#2A313A] rounded-full mx-auto mb-4 flex items-center justify-center\">\n            <Utensils className=\"text-[#C9D1D9]\" size={24} />\n          </div>\n          <h3 className=\"font-jakarta text-lg font-semibold text-text-primary mb-2\">\n            No Meals {activeTab === 'daily' ? 'Today' : 'This Week'}\n          </h3>\n          <p className=\"font-jakarta text-text-secondary mb-4\">\n            Log your meals to see {activeTab === 'daily' ? 'daily' : 'weekly'} nutrition insights\n          </p>\n          <a\n            href=\"/food\"\n            className=\"inline-flex items-center px-4 py-2 bg-[#1E49C9] text-white text-sm rounded-lg hover:bg-[#1E49C9]/80 transition-colors\"\n          >\n            LOG MEAL\n          </a>\n        </div>\n      </Card>\n    );\n  }\n\n  return (\n    <Card variant=\"elevated\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between mb-8\">\n        <h2 className=\"font-jakarta text-3xl font-bold text-text-primary\">\n          Nutrition Insights\n        </h2>\n        <button\n          onClick={handleRefresh}\n          disabled={refreshing}\n          className=\"flex items-center gap-2 px-3 py-2 font-jakarta text-sm font-medium text-text-secondary hover:text-text-primary disabled:opacity-50 transition-colors bg-background-tertiary rounded-lg border border-border-primary hover:bg-background-secondary\"\n        >\n          <RefreshCw className={`h-4 w-4 ${refreshing ? 'animate-spin' : ''}`} />\n          Refresh\n        </button>\n      </div>\n\n      {/* Tab Navigation */}\n      <div className=\"flex space-x-2 mb-8 bg-background-tertiary p-2 rounded-xl border border-border-primary\">\n        <button\n          onClick={() => setActiveTab('daily')}\n          className={`flex items-center gap-2 px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 ${\n            activeTab === 'daily'\n              ? 'bg-background-primary text-text-primary shadow-sm border border-border-primary'\n              : 'text-text-secondary hover:text-text-primary hover:bg-background-secondary'\n          }`}\n        >\n          <Calendar className=\"h-4 w-4\" />\n          Daily\n        </button>\n        <button\n          onClick={() => setActiveTab('weekly')}\n          className={`flex items-center gap-2 px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 ${\n            activeTab === 'weekly'\n              ? 'bg-background-primary text-text-primary shadow-sm border border-border-primary'\n              : 'text-text-secondary hover:text-text-primary hover:bg-background-secondary'\n          }`}\n        >\n          <BarChart3 className=\"h-4 w-4\" />\n          Weekly\n        </button>\n      </div>\n\n      {/* Nutrition Summary */}\n      <div className=\"mb-6 p-6 bg-background-tertiary rounded-xl border border-border-primary\">\n        <div className=\"grid grid-cols-4 gap-6\">\n          <div className=\"text-center\">\n            <div className=\"text-2xl font-bold text-text-primary mb-1\">{Math.round(currentNutrition.kcal || 0)}</div>\n            <div className=\"text-sm text-text-secondary font-medium\">kcal</div>\n          </div>\n          <div className=\"text-center\">\n            <div className=\"text-2xl font-bold text-text-primary mb-1\">{Math.round(currentNutrition.protein || 0)}g</div>\n            <div className=\"text-sm text-text-secondary font-medium\">protein</div>\n          </div>\n          <div className=\"text-center\">\n            <div className=\"text-2xl font-bold text-text-primary mb-1\">{Math.round(currentNutrition.carbs || 0)}g</div>\n            <div className=\"text-sm text-text-secondary font-medium\">carbs</div>\n          </div>\n          <div className=\"text-center\">\n            <div className=\"text-2xl font-bold text-text-primary mb-1\">{Math.round(currentNutrition.fat || 0)}g</div>\n            <div className=\"text-sm text-text-secondary font-medium\">fat</div>\n          </div>\n        </div>\n        \n        {/* Health Effects Summary */}\n        {Object.entries(currentEffects).some(([effectKey, effectData]) => (effectData.score || 0) > 0) && (\n          <div className=\"mt-6 pt-6 border-t border-border-primary\">\n            <details className=\"group\">\n              <summary className=\"cursor-pointer text-sm font-medium text-text-secondary hover:text-text-primary transition-colors flex items-center gap-2\">\n                <span>Effects</span>\n                <span className=\"px-2 py-1 bg-background-primary rounded-full text-xs font-semibold\">\n                  {Object.entries(currentEffects).filter(([effectKey, effectData]) => (effectData.score || 0) > 0).length}\n                </span>\n              </summary>\n              <div className=\"flex flex-wrap gap-3 mt-4\">\n                {Object.entries(currentEffects)\n                  .filter(([effectKey, effectData]) => (effectData.score || 0) > 0)\n                  .map(([effectKey, effectData]) => {\n                  const score = effectData.score || 0;\n                  const bgColor = score >= 6 ? 'bg-[#1E49C9]/20 border-[#1E49C9]/30 text-[#1E49C9]' : \n                                 score >= 4 ? 'bg-yellow-900/20 border-yellow-500/30 text-yellow-300' : \n                                 'bg-red-900/20 border-red-500/30 text-red-300';\n\n                  return (\n                    <div \n                      key={effectKey} \n                      className={`px-4 py-2 rounded-lg border text-sm cursor-pointer hover:opacity-80 transition-opacity font-medium ${bgColor}`}\n                      onClick={() => handleEffectClick(effectKey, effectData, null)}\n                    >\n                      <span className=\"font-medium\">{labels[effectKey] || effectKey}</span>\n                      <span className=\"ml-2 text-xs opacity-75\">({score})</span>\n                    </div>\n                  );\n                })}\n              </div>\n            </details>\n          </div>\n        )}\n      </div>\n\n      {/* Day-Level Summary */}\n      {currentMeals.length > 0 && (\n        <div className=\"p-6 bg-background-tertiary rounded-xl border border-border-primary\">\n          <div className=\"text-center mb-6\">\n            <div className=\"text-sm font-medium text-text-secondary\">\n              {currentMeals.length} meal{currentMeals.length !== 1 ? 's' : ''} logged {activeTab === 'daily' ? 'today' : 'this week'}\n            </div>\n          </div>\n          \n          {/* Health Impact */}\n          {Object.entries(currentEffects).some(([effectKey, effectData]) => (effectData.score || 0) > 0) && (\n            <div>\n              <div className=\"text-lg font-semibold text-text-primary mb-4 text-center\">\n                {activeTab === 'daily' ? 'Daily' : 'Weekly'} Health Impact\n              </div>\n              <div className=\"flex flex-wrap gap-3 justify-center\">\n                {Object.entries(currentEffects)\n                  .filter(([effectKey, effectData]) => (effectData.score || 0) > 0)\n                  .sort((a, b) => (b[1].score || 0) - (a[1].score || 0))\n                  .map(([effectKey, effectData]) => {\n                  const score = effectData.score || 0;\n                  const bgColor = score >= 6 ? 'bg-[#1E49C9]/20 border-[#1E49C9]/30 text-[#1E49C9]' : \n                                 score >= 4 ? 'bg-yellow-900/20 border-yellow-500/30 text-yellow-300' : \n                                 'bg-red-900/20 border-red-500/30 text-red-300';\n\n                  return (\n                    <div \n                      key={effectKey} \n                      className={`px-4 py-2 rounded-lg border text-sm cursor-pointer hover:opacity-80 transition-opacity font-medium ${bgColor}`}\n                      onClick={() => handleEffectClick(effectKey, effectData, null)}\n                    >\n                      <span className=\"font-medium\">{labels[effectKey] || effectKey}</span>\n                      <span className=\"ml-2 text-xs opacity-75\">({score})</span>\n                    </div>\n                  );\n                })}\n              </div>\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Effect Details Modal */}\n      {selectedEffect && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-background-secondary border border-border-primary rounded-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto\">\n            <div className=\"p-6\">\n              <div className=\"flex items-center justify-between mb-4\">\n                <h3 className=\"text-lg font-semibold text-text-primary\">\n                  {icons[selectedEffect.key]} {labels[selectedEffect.key]} Details\n                </h3>\n                <button\n                  onClick={closeEffectDetails}\n                  className=\"text-text-muted hover:text-text-primary transition-colors\"\n                >\n                  ✕\n                </button>\n              </div>\n              \n              <div className=\"mb-4\">\n                <div className=\"flex items-center justify-between mb-2\">\n                  <span className=\"text-sm font-medium text-text-primary\">Score</span>\n                  <span className={`text-lg font-bold ${getMealEffectLevel(selectedEffect.data.score || 0).color}`}>\n                    {selectedEffect.data.score || 0}/10\n                  </span>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-sm font-medium text-text-primary\">Level</span>\n                  <span className=\"text-sm text-text-secondary\">\n                    {selectedEffect.data.label || selectedEffect.data.level || 'N/A'}\n                  </span>\n                </div>\n              </div>\n\n              <div className=\"mb-4\">\n                <h4 className=\"text-sm font-medium text-text-primary mb-2\">Contributing Factors</h4>\n                {selectedEffect.data.why && selectedEffect.data.why.length > 0 ? (\n                  <ul className=\"space-y-1\">\n                    {selectedEffect.data.why.map((reason, index) => (\n                      <li key={index} className=\"text-sm text-text-secondary flex items-start\">\n                        <span className=\"mr-2\">•</span>\n                        <span>{reason}</span>\n                      </li>\n                    ))}\n                  </ul>\n                ) : (\n                  <p className=\"text-sm text-text-muted\">No specific factors identified</p>\n                )}\n              </div>\n\n              {/* AI Insights */}\n              {selectedEffect.data.aiInsights && (\n                <div className=\"mb-4 p-3 bg-blue-900/20 border border-blue-500/30 rounded-lg\">\n                  <div className=\"flex items-center gap-2 mb-2\">\n                    <span className=\"text-sm\">AI</span>\n                    <h4 className=\"text-sm font-medium text-blue-300\">AI Insights</h4>\n                  </div>\n                  <p className=\"text-sm text-blue-200 leading-relaxed\">\n                    {selectedEffect.data.aiInsights}\n                  </p>\n                </div>\n              )}\n\n              {/* AI Enhanced Indicator */}\n              {selectedEffect.data.aiEnhanced && (\n                <div className=\"mb-4 flex items-center gap-2 text-xs text-[#1E49C9]\">\n                  <span>✨</span>\n                  <span>Enhanced with AI analysis</span>\n                </div>\n              )}\n\n              <div className=\"mb-4\">\n                <h4 className=\"text-sm font-medium text-text-primary mb-2\">\n                  {selectedMeal ? 'Meal Items' : 'All Meals Today'}\n                </h4>\n                <div className=\"space-y-2\">\n                  {selectedMeal ? (\n                    selectedMeal.items.map((item, index) => (\n                      <div key={index} className=\"flex items-center justify-between p-2 bg-background-tertiary rounded\">\n                        <span className=\"text-sm text-text-primary\">{item.customName}</span>\n                        <span className=\"text-xs text-text-secondary\">{item.grams}g</span>\n                      </div>\n                    ))\n                  ) : (\n                    currentMeals\n                      .filter(meal => (meal.computed?.effects?.[selectedEffect.key]?.score || 0) > 0)\n                      .map((meal, mealIndex) => (\n                        <div key={mealIndex} className=\"p-2 bg-background-tertiary rounded\">\n                          <div className=\"text-sm font-medium text-text-primary mb-1\">\n                            Meal {mealIndex + 1} - {formatMealTime(meal.ts)}\n                          </div>\n                          <div className=\"space-y-1\">\n                            {meal.items.map((item, itemIndex) => (\n                              <div key={itemIndex} className=\"flex items-center justify-between text-xs\">\n                                <span className=\"text-text-secondary\">{item.customName}</span>\n                                <span className=\"text-text-muted\">{item.grams}g</span>\n                              </div>\n                            ))}\n                          </div>\n                        </div>\n                      ))\n                  )}\n                </div>\n              </div>\n\n              <div className=\"flex justify-end\">\n                <button\n                  onClick={closeEffectDetails}\n                  className=\"px-4 py-2 bg-primary text-white rounded hover:bg-primary/90 transition-colors\"\n                >\n                  Close\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </Card>\n  );\n};\n\nexport default DailyMealKPIs;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}